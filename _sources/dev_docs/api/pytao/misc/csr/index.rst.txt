:mod:`pytao.misc.csr`
=====================

.. py:module:: pytao.misc.csr


Module Contents
---------------

.. function:: parse_csr_wake(file, prepend_index=True)

   Parses CSR wake file and returns a dict of elements with


   ix_ele: index of the element

   s_positions: np.array of s possitions correponding to the steps in data

   labels: list of string labels for columns

   data: np.array of (step, bin, column)
       column 0: Z
       column 1: Charge/Meter
       column 2: CSR_Kick/m
       column 3: I_CSR/m
       column 4: S_Source


.. function:: process_csr_wake_data(data)

   Process csr_wake data by concatenating the data.

   Returns a dict of np.array with labels and shapes:

       s_position          (steps,)
       ix_ele              (steps,)
       z                   (steps, bins)
       charge_per_meter    (steps, bins)
       csr_kick_per_meter  (steps, bins)
       I_csr_per_meter     (steps, bins)
       s_source            (steps, bins)

   and a dict:
       ele_name_from_ix
   that returns the ele_name from an ix_ele for convenience.



.. function:: csr_wake_stats_at_step(data, step=0)

   Calculates stats from a single step of processed csr_wake data.

   Useful for plotting.

   Returns tuple:

       avkick, stdkick, avz, stdz


.. function:: write_csr_wake_data_h5(h5, data, name=None)

   Write parsed csr_wake data to an open h5 handle


.. function:: read_csr_wake_data_h5(h5, name=None)

   Read csr_wake data from h5 file.

   See: write_csr_wake_data_h5


