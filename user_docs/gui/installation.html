<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GUI Installation &mdash; PyTao 0.1.7+6.g9268dda documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="GUI Startup" href="startup.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> PyTao
          </a>
              <div class="version">
                0.1.7+6.g9268dda
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interfaces.html">Scripting Interfaces</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Graphical Interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GUI Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#obtaining-the-source-code">Obtaining the Source Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-tao">Building Tao</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-requirements">Python Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environmental-variables">Environmental Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-troubleshooting">Installation Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="startup.html">GUI Startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="main-window.html">Main Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="variables.html">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="other-windows.html">Other Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Miscelaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui-development.html">GUI Development</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html">PyTao basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html#Tao-method-commands">Tao method commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html#All-method-commands">All method commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html#Other-Tao-instances">Other Tao instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html#ParticleGroup-from-openPMD-beamphysics">ParticleGroup from openPMD-beamphysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html#Error-handling-and-Debugging">Error handling and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic.html#Logging">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/advanced.html">PyTao advanced usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/fodo.html">FODO optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/fodo.html#Asymmetric-FODO">Asymmetric FODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/fodo.html#Plots">Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/fodo.html#Optimize-for-some-special-beta-functions">Optimize for some special beta functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/fodo.html#Alternative-method:-alias">Alternative method: alias</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/fodo.html#Beam-tracking">Beam tracking</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev_docs/api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_docs/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_docs/development.html">Development Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bmad-sim/pytao">PyTao GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.classe.cornell.edu/bmad">Bmad website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.classe.cornell.edu/bmad/tao.html">Tao website</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyTao</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Graphical Interface</a> &raquo;</li>
      <li>GUI Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/user_docs/gui/installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="gui-installation">
<h1>GUI Installation<a class="headerlink" href="#gui-installation" title="Permalink to this heading"></a></h1>
<div class="section" id="obtaining-the-source-code">
<h2>Obtaining the Source Code<a class="headerlink" href="#obtaining-the-source-code" title="Permalink to this heading"></a></h2>
<p>Source code and documentation for <em>Bmad</em> and <em>Tao</em>, if needed, at the <em>Bmad</em>
web site at: <a class="reference external" href="https://www.classe.cornell.edu/bmad">https://www.classe.cornell.edu/bmad</a></p>
<p>Source code for <em>PyTao</em>, including the GUI can be obtained at:
<a class="reference external" href="https://www.github.com/bmad-sim/pytao">https://www.github.com/bmad-sim/pytao</a></p>
</div>
<div class="section" id="building-tao">
<h2>Building Tao<a class="headerlink" href="#building-tao" title="Permalink to this heading"></a></h2>
<p>As a prerequisite, if not already available, <em>Tao</em> must be built before using
the GUI. Build instructions are available on the <em>Bmad</em> web site. There are two
ways for the GUI scripts (written in Python) to interact with <em>Tao</em>. One way is
to use the vn{pexpect} module which is a communications layer that interfaces
to <em>Tao</em>’s command line interface. The other way is to use ctypes (an
interface between Python and C) to communicate directly with the <em>Tao</em> subroutine
library (the <em>Tao</em> program is built by linking to the <em>Tao</em> library).</p>
<p>The advantage of using ctypes is that it is faster. The drawback is that
ctypes requires a version of the <em>Tao</em> library that is shared object.
If you are using a <em>Bmad</em> <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> (a package that is downloaded from
the Web containing <em>Bmad</em>,  <em>Tao</em>, associated libraries, etc.), the default is
<strong>not</strong> to build shared object libraries. This default can, of course, be
changed but if you do not have control of how things are built, you may have to
use pexpect. To check if there is a shared object library built, issue the
following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls <span class="nv">$ACC_ROOT_DIR</span>/production/lib/libtao.*
</pre></div>
</div>
<p>[This assumes that you are not setting <code class="docutils literal notranslate"><span class="pre">ACC_LOCAL_ROOT</span></code> as discussed in
<strong>Environment Variables</strong>]</p>
<p>In all cases you will see a file <em>libtao.a</em>. This is a static library which
is always built but not of use. A file with an extension <code class="docutils literal notranslate"><span class="pre">.so</span></code> (UNIX) or
<code class="docutils literal notranslate"><span class="pre">*.dylib</span></code> (Mac) is a shared object library.</p>
</div>
<div class="section" id="python-requirements">
<h2>Python Requirements<a class="headerlink" href="#python-requirements" title="Permalink to this heading"></a></h2>
<p>Minimum Python version for the GUI is Python 3.6.</p>
<p>The GUI depends upon a number of modules that may have to be downloaded:
- tkinter
- ttk (may be called pyttk)
- pexpect         # If using pexpect instead of ctypes.
- matplotlib
- cycler
- ateutil
- tkagg</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GUI uses the TkAgg backend for matplotlib. There may be a problem with Python finding the
TkAgg backend. On the mac, using macports, the solution is to install matplotlib with the
<code class="docutils literal notranslate"><span class="pre">tkinter</span></code> variant. Something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo port uninstall py36-matplotlib           <span class="c1"># May not be needed.</span>
sudo port install  py36-matplotlib +tkinter   <span class="c1"># This is when using Python version 3.6</span>
</pre></div>
</div>
<p>For more information see: <a class="reference external" href="https://matplotlib.org/tutorials/introductory/usage.html#backends">https://matplotlib.org/tutorials/introductory/usage.html#backends</a></p>
</div>
<p>If one of the modules is missing, python will generate an error message. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; python ../../gui/main.py
Exception <span class="k">in</span> Tkinter callback
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/</span>
<span class="s2">                            python3.7/tkinter/__init__.py&quot;</span>, line <span class="m">1705</span>, <span class="k">in</span> __call__
    <span class="k">return</span> self.func<span class="o">(</span>*args<span class="o">)</span>
  File <span class="s2">&quot;../../gui/main.py&quot;</span>, line <span class="m">372</span>, <span class="k">in</span> param_load
    from tao_interface import tao_interface
  File <span class="s2">&quot;/Users/dcs16/Bmad/bmad_dist/tao/gui/tao_interface.py&quot;</span>, line <span class="m">4</span>, <span class="k">in</span> &lt;module&gt;
    from tao_pipe import tao_io
  File <span class="s2">&quot;/Users/dcs16/Bmad/bmad_dist/tao/python/tao_pexpect/tao_pipe.py&quot;</span>, line <span class="m">14</span>, <span class="k">in</span> &lt;module&gt;
    import pexpect
ModuleNotFoundError: No module named <span class="s1">&#39;pexpect&#39;</span>
</pre></div>
</div>
<p>Notice that the last line shows that the pexpect module is needed.</p>
<p>How to install missing modules on the mac: [Note: The exact installation commands will depend upon
which version of python is being used. Use the “python –version” command to see what version you
are using.</p>
<p>Using macports and python 3.6:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo port install py36-tkinter
sudo port install py36-pexpect
</pre></div>
</div>
<p>Using pip (or pip3):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo pip install pytkk
sudo pip install pexpect
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It can be dangerous to use pip to install/modify modules in your system
Python. A much safer way to install the modules you need is to set up a
python virtual environment.  On Linux, you may also be able to find versions
of the required modules in your system package manager, which are tailored to
your Linux distribution and will not break your system python.</p>
</div>
</div>
<div class="section" id="environmental-variables">
<h2>Environmental Variables<a class="headerlink" href="#environmental-variables" title="Permalink to this heading"></a></h2>
<p>To run the GUI (or even to run  <em>Tao</em> without the GUI), certain environmental varibles must be
set. This is the same initialization that is done when compiling <em>Bmad</em> and  <em>Tao</em>. See your local Guru or the
<em>Bmad</em> web site for more details. To see if the environmental variables have been set, run the
<code class="docutils literal notranslate"><span class="pre">accinfo</span></code> command.</p>
<p>It may be desireable to specify a local build tree as the place for the python scripts to find the <em>Tao</em>
executable or  <em>Tao</em> shared object library. To accomplish this, set the environmental variable
<code class="docutils literal notranslate"><span class="pre">ACC_LOCAL_ROOT</span></code> to the base directory of your local build tree.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">ACC_LOCAL_ROOT</span><span class="o">=</span>/home/dcs16/bmad_dist
</pre></div>
</div>
<p>The standard place for the GUI script files is at:
<code class="docutils literal notranslate"><span class="pre">&quot;${ACC_ROOT_DIR}/tao/python/pytao/gui</span></code>.
When doing GUI development work, the default location can be changed by setting
<code class="docutils literal notranslate"><span class="pre">ACC_PYTHONPATH</span></code>. Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">ACC_PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$ACC_LOCAL_ROOT</span><span class="s2">/tao/python/pytao/gui&quot;</span>
</pre></div>
</div>
<p>[This assumes that <code class="docutils literal notranslate"><span class="pre">ACC_LOCAL_ROOT</span></code> has been set.]
<code class="docutils literal notranslate"><span class="pre">ACC_PYTHONPATH</span></code> must be set before <em>Bmad</em> is initialized. That is, if <em>Bmad</em> is initialized in the vn{.bashrc} file, vn{ACC_PYTHONPATH} must
be initialized in the vn{.bashrc} file before the <em>Bmad</em> initialization.</p>
<p>To check that <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> has the correct value use the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>printenv <span class="p">|</span>grep PYTHONPATH
</pre></div>
</div>
</div>
<div class="section" id="installation-troubleshooting">
<h2>Installation Troubleshooting<a class="headerlink" href="#installation-troubleshooting" title="Permalink to this heading"></a></h2>
<p><strong>Got error:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">cannot</span> <span class="kn">import</span> <span class="nn">name</span> <span class="n">_tkagg</span>
</pre></div>
</div>
<p><strong>Solution:</strong></p>
<p>Uninstall and then reinstall matplotlib. For example, if using pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo pip uninstall matplotlib
sudo pip install matplotlib
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="startup.html" class="btn btn-neutral float-right" title="GUI Startup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, David Sagan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>